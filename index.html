<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sírfidos Vs Pulgonautas: Misión Estratosfera</title>
  <meta name="author" content="Elisa Garzo y María Ángeles Marcos García" />
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
  <script src="https://cdn.rawgit.com/donmccurdy/aframe-physics-system/v3.3.0/dist/aframe-physics-system.min.js"></script>

  <script>
    AFRAME.registerComponent('loader', {
      init: function () {
        this.el.setAttribute('visible', false);
        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              this.el.setAttribute('visible', true);
              observer.disconnect();
            }
          });
        }, {threshold: 0.5});
        observer.observe(this.el);
      }
    });
  </script>
</head>
<body>
  <a-scene physics="debug: false">
    <a-assets>
      <!-- Modelos -->
      <a-asset-item id="museo-glb" src="museo.glb"></a-asset-item>
      <a-asset-item id="GV-glb" src="GV.glb"></a-asset-item>
      <a-asset-item id="DE-glb" src="DE.glb"></a-asset-item>
      <!-- ... otros .glb ... -->

      <!-- Vídeos optimizados -->
      <video id="Estilectomia" src="Estilectomia_720p.mp4" crossorigin="anonymous" playsinline autoplay loop preload="none"></video>
      <video id="LarvaPulgon" src="larvapulgon_720p.mp4" crossorigin="anonymous" playsinline autoplay loop preload="none"></video>
      <!-- ... otros vídeos reducidos ... -->
    </a-assets>

    <!-- Modelo del museo (estático) -->
    <a-entity gltf-model="#museo-glb" position="10 0 10" scale="10 10 10">
      <!-- Ejemplo de modelo cargado por proximidad -->
      <a-entity gltf-model="#GV-glb"
                loader
                position="0 90 -34"
                scale="3 3 3"
                material="shader: flat">
      </a-entity>

      <a-entity gltf-model="#DE-glb"
                loader
                position="80 90 -34"
                scale="2 2 2"
                material="shader: flat">
      </a-entity>
      <!-- Añade más entidades con loader donde sea necesario -->
    </a-entity>

    <!-- Vídeos en pared -->
    <a-video src="#Estilectomia" position="-316 1.6 150"
             rotation="0 90 180" width="96" height="54"></a-video>
    <a-video src="#LarvaPulgon" position="400 -10 310"
             rotation="180 90 180" width="96" height="54"></a-video>
    <!-- Más vídeos... -->

    <!-- Sírfido animado -->
    <a-entity gltf-model="#GV-glb"
              loader
              position="-320 80 -150"
              rotation="0 90 0"
              scale="3 3 3"
              animation="property: position; to: 400 80 -350; dur: 5000; easing: linear; loop: true; dir: alternate;">
    </a-entity>

    <!-- Cámara optimizada -->
    <a-entity camera="far: 500; fov: 60"
              position="-200 10 -300"
              look-controls
              wasd-controls="acceleration: 50000"
              look-at="190 10 -34">
    </a-entity>

    <!-- Iluminación simplificada -->
    <a-light type="ambient" color="#FFFFFF" intensity="0.5"></a-light>
    <a-light type="point" color="#FFFFFF" intensity="0.35" position="0 4 0"></a-light>
  </a-scene>
</body>
</html>





